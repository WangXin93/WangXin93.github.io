---
layout: post
title:  "使用nc在局域网内传输文件"
date:   2018-02-14 18:25:00 +0800
categories: Linux
---

## 前言
**情人节快乐!**

在家中或者学校，经常需要在多台电脑之间传输文件，怎么传文件才方便呢？
1. 存到U盘，再把U盘插到另一台电脑
2. 家中或者学校的多台电脑通常连接在一个局域网中，可以用它吗？

可以！

## 如何在局域网内传输文件？

这里UNIX系统携带的工具`nc`或者叫`netcat`，使用`man nc`可以查看关于它的介绍与说明。`nc`可以帮助在一台计算机打开一个端口，而在另一台计算机可以使用`nc`访问这个端口，从而可以在两台计算机之间传输数据。

假定需要讲文件从电脑A传输到电脑B，首先，需要在电脑B终端输入：
```bash
$ nc -l 1234 > filename.out
```
这里做的事情是在电脑B开放一个端口，端口号为1234，就像一幢大楼的号码为1234的房间门打开来等待其他计算机的访问。传输的数据会被存放在命名为`filename.out`的文件，如果没有这个文件，`nc`会自己创建一个。

然后，要知道电脑B端的局域网IP地址，在电脑B终端输入：
```bash
$ ifconfig
enp3s0    Link encap:以太网  硬件地址 f0:de:f1:f3:ce:9e  
          UP BROADCAST MULTICAST  MTU:1500  跃点数:1
          接收数据包:0 错误:0 丢弃:0 过载:0 帧数:0
          发送数据包:0 错误:0 丢弃:0 过载:0 载波:0
          碰撞:0 发送队列长度:1000 
          接收字节:0 (0.0 B)  发送字节:0 (0.0 B)

lo        Link encap:本地环回  
          inet 地址:127.0.0.1  掩码:255.0.0.0
          inet6 地址: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  跃点数:1
          接收数据包:3290 错误:0 丢弃:0 过载:0 帧数:0
          发送数据包:3290 错误:0 丢弃:0 过载:0 载波:0
          碰撞:0 发送队列长度:1000 
          接收字节:1265913 (1.2 MB)  发送字节:1265913 (1.2 MB)

wlp9s0    Link encap:以太网  硬件地址 44:6d:57:5e:b0:42  
          inet 地址:192.168.2.102  广播:192.168.2.255  掩码:255.255.255.0
          inet6 地址: fe80::6eb3:6513:bb2c:cfbe/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  跃点数:1
          接收数据包:150949 错误:0 丢弃:0 过载:0 帧数:0
          发送数据包:97071 错误:0 丢弃:0 过载:0 载波:0
          碰撞:0 发送队列长度:1000 
          接收字节:193005806 (193.0 MB)  发送字节:11263841 (11.2 MB)
```
关注`wlp9s0`这一行，可以知道电脑B的局域网IP为`192.168.2.102`。

然后，在电脑A的终端输入：
```bash
$ nc 192.168.2.102 1234 < filename.in
```
等待命令执行完成，命名为`filename.in`的文件会被传输到电脑B。文件传输完成后，连接会自动断开。大功告成～利用局域网成功在两台计算机之间传输文件。

**完整帮助参考命令`man nc`,然后键入`/DATA TRANSFER`，寻找到相关章节**


## 使用scp向Linux云服务器上传和下载文件
随着时间推移，我发现了更多向云端传输数据的方法。使用nc传输数据时，有时候因为`<`符号弄反了导致待复制文件被重写真的太恐怖了。
下面介绍scp指令的使用。scp指令的基本格式如下：
```
scp <name@ip-address>:</path/of/file> <name@ip-address>:</path/of/file>
```
举例来说：
```
scp ./warm_up_train_20180201.tar wangx@111.233.77.222:/home/wangx/test
```
这行指令就能够将本地的这个tar文件上传到云端的test目录。按下回车确认后，还能够显示传输进度，比nc真的美丽多了。

## 使用sftp向Linux云服务器上传和下载文件
sftp提供了交互式的文件传输方案，使文件传输任务更加可爱方便了！如何使用sftp？
```
scp user@ip-address
```
举例来说：
```
scp ubuntu@192.168.0.1
```
然后命令行的提示符号会变为`sftp> `，现在你就可以使用sftp的指令了，常用指令包括：
```
put filename # 上传文件
put -r dirname # 上传文件夹
get filename # 下载文件
get -r dirname # 下载文件夹
cd # 改变远程服务器目录
lcd # 改变当前主机目录
pwd # 显示远程服务器当前工作目录
lpwd # 显示当前主机（本地）的当前工作目录
```

## Next: rsync
